import Decimal from "decimal.js";
import { Universe } from "../proto/definition";
import { msgpackableAxios } from "../types";
import { OmniversalChainID } from "../data";
import { bytesToHex } from "viem";
export async function getBalances(vscURL, universe, address) {
    const resp = await msgpackableAxios({
        baseURL: vscURL,
        url: `/api/v1/get-balance/${Universe[universe]}/${bytesToHex(address)}`,
    });
    const { data } = resp;
    return data.balances.map(bal => ({
        chainID: new OmniversalChainID(bal.universe, bal.chain_id),
        totalValue: new Decimal(bal.total_usd),
        currencywise: bal.currencies.map(cur => ({
            tokenAddress: cur.token_address,
            amount: new Decimal(cur.balance),
            value: new Decimal(cur.value)
        }))
    }));
}
